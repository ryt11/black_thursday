<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Code coverage for Black thursday</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='./assets/0.10.0/application.js' type='text/javascript'></script>
    <link href='./assets/0.10.0/application.css' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link rel="shortcut icon" type="image/png" href="./assets/0.10.0/favicon_red.png" />
    <link rel="icon" type="image/png" href="./assets/0.10.0/favicon.png" />
  </head>

  <body>
    <div id="loading">
      <img src="./assets/0.10.0/loading.gif" alt="loading"/>
    </div>
    <div id="wrapper" style="display:none;">
      <div class="timestamp">Generated <abbr class="timeago" title="2017-03-01T11:11:21-07:00">2017-03-01T11:11:21-07:00</abbr></div>
      <ul class="group_tabs"></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles">
  <h2>
    <span class="group_name">All Files</span>
    (<span class="covered_percent"><span class="red">48.03%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         7.78
       </span>
    </span> hits/line)
  </h2>
  <a name="AllFiles"></a>
  <div>
    <b>14</b> files in total.
    <b>508</b> relevant lines.
    <span class="green"><b>244</b> lines covered</span> and
    <span class="red"><b>264</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>

      <tr>
        <td class="strong"><a href="#3134c63a7b721115a44e5abf2995342dd548cf36" class="src_link" title="lib/customer.rb">lib/customer.rb</a></td>
        <td class="red strong">52.38 %</td>
        <td>38</td>
        <td>21</td>
        <td>11</td>
        <td>10</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#203392170c9f87d77610f04f2c9175b91bc9ee46" class="src_link" title="lib/customer_repository.rb">lib/customer_repository.rb</a></td>
        <td class="red strong">48.39 %</td>
        <td>54</td>
        <td>31</td>
        <td>15</td>
        <td>16</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#e86eb81218ae5d2519803a0c52cd3e34d95a1dcc" class="src_link" title="lib/invoice.rb">lib/invoice.rb</a></td>
        <td class="red strong">48.65 %</td>
        <td>65</td>
        <td>37</td>
        <td>18</td>
        <td>19</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#116ae1db480822d94927720d81c4998a91e9bdb2" class="src_link" title="lib/invoice_item.rb">lib/invoice_item.rb</a></td>
        <td class="red strong">57.69 %</td>
        <td>47</td>
        <td>26</td>
        <td>15</td>
        <td>11</td>
        <td>0.6</td>
      </tr>

      <tr>
        <td class="strong"><a href="#28d4ed6b21bea6e0a5836f15bd402efaed29f0c1" class="src_link" title="lib/invoice_item_repository.rb">lib/invoice_item_repository.rb</a></td>
        <td class="red strong">48.28 %</td>
        <td>60</td>
        <td>29</td>
        <td>14</td>
        <td>15</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#f6af1c7cd54d0507283b8bd83523ec9b966f5c96" class="src_link" title="lib/invoice_repository.rb">lib/invoice_repository.rb</a></td>
        <td class="red strong">47.06 %</td>
        <td>60</td>
        <td>34</td>
        <td>16</td>
        <td>18</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#36d7b4b235c219515069af3fd75d6c24f1f7740f" class="src_link" title="lib/item.rb">lib/item.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>42</td>
        <td>24</td>
        <td>16</td>
        <td>8</td>
        <td>46.4</td>
      </tr>

      <tr>
        <td class="strong"><a href="#d519c8788af8cca267b5f4025649c81dbd321fc4" class="src_link" title="lib/item_repository.rb">lib/item_repository.rb</a></td>
        <td class="red strong">59.52 %</td>
        <td>77</td>
        <td>42</td>
        <td>25</td>
        <td>17</td>
        <td>17.1</td>
      </tr>

      <tr>
        <td class="strong"><a href="#7ec9e8fd8e7804df328160abe3c36fa32816898a" class="src_link" title="lib/merchant.rb">lib/merchant.rb</a></td>
        <td class="red strong">57.89 %</td>
        <td>34</td>
        <td>19</td>
        <td>11</td>
        <td>8</td>
        <td>32.1</td>
      </tr>

      <tr>
        <td class="strong"><a href="#bf55b889cea61203b31335916f3d1b6cc1c87606" class="src_link" title="lib/merchant_repository.rb">lib/merchant_repository.rb</a></td>
        <td class="red strong">68.75 %</td>
        <td>53</td>
        <td>32</td>
        <td>22</td>
        <td>10</td>
        <td>35.6</td>
      </tr>

      <tr>
        <td class="strong"><a href="#adda5699a402641ace8d09b8c6a979fcb2ef9de5" class="src_link" title="lib/sales_analyst.rb">lib/sales_analyst.rb</a></td>
        <td class="red strong">28.37 %</td>
        <td>263</td>
        <td>141</td>
        <td>40</td>
        <td>101</td>
        <td>0.3</td>
      </tr>

      <tr>
        <td class="strong"><a href="#ddc95a70e5f6fd92fd404dc085fe545edf8ef231" class="src_link" title="lib/sales_engine.rb">lib/sales_engine.rb</a></td>
        <td class="red strong">80.0 %</td>
        <td>26</td>
        <td>20</td>
        <td>16</td>
        <td>4</td>
        <td>10.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#c4da46909e26004c5a2c40d600ef72d38e1a5743" class="src_link" title="lib/transaction.rb">lib/transaction.rb</a></td>
        <td class="red strong">52.38 %</td>
        <td>40</td>
        <td>21</td>
        <td>11</td>
        <td>10</td>
        <td>0.5</td>
      </tr>

      <tr>
        <td class="strong"><a href="#f4b419e7b607729b85013de15074ff443f2b5cdb" class="src_link" title="lib/transaction_repository.rb">lib/transaction_repository.rb</a></td>
        <td class="red strong">45.16 %</td>
        <td>59</td>
        <td>31</td>
        <td>14</td>
        <td>17</td>
        <td>0.5</td>
      </tr>

    </tbody>
  </table>
</div>



      </div>

      <div id="footer">
        Generated by <a href="http://github.com/colszowka/simplecov">simplecov</a> v0.13.0
        and simplecov-html v0.10.0<br/>
        using Unit Tests
      </div>

      <div class="source_files">

        <div class="source_table" id="3134c63a7b721115a44e5abf2995342dd548cf36">
  <div class="header">
    <h3>lib/customer.rb</h3>
    <h4><span class="red">52.38 %</span> covered</h4>
    <div>
      <b>21</b> relevant lines.
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>10</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">require &#39;bigdecimal&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">require &#39;pry&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">class Customer</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">    attr_reader :customer_info, :cust_repo_instance</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  def initialize(customer_info, cust_repo_instance)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    @customer_info = customer_info</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">    @cust_repo_instance = cust_repo_instance</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>

          <code class="ruby">  def first_name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    @customer_info[:first_name]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>

          <code class="ruby">  def id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">    @customer_info[:id]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>

          <code class="ruby">  def last_name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">    @customer_info[:last_name]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>

          <code class="ruby">  def created_at</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">    @customer_info[:created_at]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>

          <code class="ruby">  def updated_at</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="30">


          <code class="ruby">    @customer_info[:updated_at]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>

          <code class="ruby">  def merchants</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="34">


          <code class="ruby">    invoices = cust_repo_instance.se_inst.invoices.find_all_by_customer_id(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="35">


          <code class="ruby">    merchant_ids = invoices.map { |invoice| invoice.merchant_id }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="36">


          <code class="ruby">    merchant_ids.map { |merchant_id| cust_repo_instance.se_inst.merchants.find_by_id(merchant_id) }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="203392170c9f87d77610f04f2c9175b91bc9ee46">
  <div class="header">
    <h3>lib/customer_repository.rb</h3>
    <h4><span class="red">48.39 %</span> covered</h4>
    <div>
      <b>31</b> relevant lines.
      <span class="green"><b>15</b> lines covered</span> and
      <span class="red"><b>16</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">require_relative &#39;customer&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">require &#39;csv&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">require &#39;pry&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">require &#39;bigdecimal&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">require &#39;time&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">class CustomerRepository</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>

          <code class="ruby">  attr_reader :file, :customers, :se_inst</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>

          <code class="ruby">  def initialize(file, se_inst)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    @file = file</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">    @se_inst = se_inst</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">    @customers = Hash.new(0)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    customer_maker</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>

          <code class="ruby">  def open_contents</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">    CSV.open(file, headers: true, header_converters: :symbol)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>

          <code class="ruby">  def customer_maker</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">    open_contents.each do |row|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="22">


          <code class="ruby">    @customers[row[:id].to_i] = Customer.new({:id =&gt; row[:id].to_i, :first_name =&gt; row[:first_name], :last_name =&gt; row[:last_name],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">    :created_at =&gt; Time.parse(row[:created_at]), :updated_at =&gt; Time.parse(row[:updated_at])}, self)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>

          <code class="ruby">  def all</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">    customers.values</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>

          <code class="ruby">  def find_by_id(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="33">


          <code class="ruby">    customers.has_key?(id) ? customers[id] : nil</code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>

          <code class="ruby">  def find_all_by_first_name(name_fragment)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="37">


          <code class="ruby">      found_customers = all.select do |customer|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="38">


          <code class="ruby">         customer.first_name.downcase.include?(name_fragment.downcase) ? customer.first_name : next</code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby">      end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="40">


          <code class="ruby">      found_customers.compact</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>

          <code class="ruby">  def find_all_by_last_name(name_fragment)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="44">


          <code class="ruby">    found_customers = all.select do |customer|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="45">


          <code class="ruby">       customer.last_name.downcase.include?(name_fragment.downcase) ? customer.last_name : next</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="47">


          <code class="ruby">    found_customers.compact</code>
        </li>

        <li class="never" data-hits="" data-linenumber="48">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="49">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>

          <code class="ruby">  def inspect</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="51">


          <code class="ruby">    &quot;#&lt;#{self.class} #{@customers.size} rows&gt;&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby">    #possibly need to change @merchants to @customers, check harness</code>
        </li>

        <li class="never" data-hits="" data-linenumber="53">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="54">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="e86eb81218ae5d2519803a0c52cd3e34d95a1dcc">
  <div class="header">
    <h3>lib/invoice.rb</h3>
    <h4><span class="red">48.65 %</span> covered</h4>
    <div>
      <b>37</b> relevant lines.
      <span class="green"><b>18</b> lines covered</span> and
      <span class="red"><b>19</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">require &#39;bigdecimal&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">require &#39;pry&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">require &#39;time&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">class Invoice</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">attr_reader :invoice_info, :inv_parent</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  def initialize(invoice_info, inv_parent)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    @invoice_info = invoice_info</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">    @inv_parent = inv_parent</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>

          <code class="ruby">  def id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    invoice_info[:id]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>

          <code class="ruby">  def customer_id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">    invoice_info[:customer_id]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>

          <code class="ruby">  def status</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">    invoice_info[:status]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>

          <code class="ruby">  def created_at</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="25">


          <code class="ruby">    invoice_info[:created_at]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>

          <code class="ruby">  def updated_at</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">    invoice_info[:updated_at]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>

          <code class="ruby">  def merchant_id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="33">


          <code class="ruby">    invoice_info[:merchant_id]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>

          <code class="ruby">  def items</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="37">


          <code class="ruby">    invoice_items_found = inv_parent.se_inst.invoice_items.find_all_by_invoice_id(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="38">


          <code class="ruby">    item_ids = invoice_items_found.map { |invoice_item| invoice_item.item_id }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="39">


          <code class="ruby">    item_ids.map {|item_id| inv_parent.se_inst.items.find_by_id(item_id)}</code>
        </li>

        <li class="never" data-hits="" data-linenumber="40">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>

          <code class="ruby">  def transactions</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="43">


          <code class="ruby">    inv_parent.se_inst.transactions.find_all_by_invoice_id(id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>

          <code class="ruby">  def customer</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="47">


          <code class="ruby">    inv_parent.se_inst.customers.find_by_id(customer_id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="48">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="49">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>

          <code class="ruby">  def merchant</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="51">


          <code class="ruby">    inv_parent.se_inst.merchants.find_by_id(merchant_id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="53">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>

          <code class="ruby">  def is_paid_in_full?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="55">


          <code class="ruby">    found = inv_parent.se_inst.transactions.find_all_by_invoice_id(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="56">


          <code class="ruby">    found.any? { |transaction| transaction.result == &quot;success&quot; }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="57">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="58">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>

          <code class="ruby">  def total</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="60">


          <code class="ruby">    return 0.0 unless is_paid_in_full?</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="61">


          <code class="ruby">    invoice_items_found = inv_parent.se_inst.invoice_items.find_all_by_invoice_id(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="62">


          <code class="ruby">    invoice_items_found.map  { |invoice_item| invoice_item.quantity * invoice_item.unit_price }.reduce(:+)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="63">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="64">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="65">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="116ae1db480822d94927720d81c4998a91e9bdb2">
  <div class="header">
    <h3>lib/invoice_item.rb</h3>
    <h4><span class="red">57.69 %</span> covered</h4>
    <div>
      <b>26</b> relevant lines.
      <span class="green"><b>15</b> lines covered</span> and
      <span class="red"><b>11</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">require &#39;bigdecimal&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">require &#39;pry&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">require &#39;time&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">class InvoiceItem</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">  attr_reader :invoice_item_info, :inv_repo_instance</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  def initialize(invoice_item_info, inv_item_repo_instance)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    @invoice_item_info = invoice_item_info</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">    @inv_repo_instance = inv_item_repo_instance</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>

          <code class="ruby">  def id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    invoice_item_info[:id]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>

          <code class="ruby">  def item_id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">    invoice_item_info[:item_id]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>

          <code class="ruby">  def invoice_id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">    invoice_item_info[:invoice_id]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>

          <code class="ruby">  def quantity</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="25">


          <code class="ruby">    invoice_item_info[:quantity]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>

          <code class="ruby">  def unit_price</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">    invoice_item_info[:unit_price]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>

          <code class="ruby">  def created_at</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="33">


          <code class="ruby">    invoice_item_info[:created_at]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>

          <code class="ruby">  def updated_at</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="37">


          <code class="ruby">    invoice_item_info[:updated_at]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>

          <code class="ruby">  def unit_price_to_dollars</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="41">


          <code class="ruby">    unit_price.to_f / 100</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>

          <code class="ruby">  def item</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="45">


          <code class="ruby">    inv_item_repo_instance.se_inst.items.find_by_id(id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="47">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="28d4ed6b21bea6e0a5836f15bd402efaed29f0c1">
  <div class="header">
    <h3>lib/invoice_item_repository.rb</h3>
    <h4><span class="red">48.28 %</span> covered</h4>
    <div>
      <b>29</b> relevant lines.
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>15</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">require_relative &#39;invoice_item&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">require &#39;csv&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">require &#39;pry&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">require &#39;bigdecimal&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">class InvoiceItemRepository</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">  attr_reader :file, :invoice_items, :se_inst</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  def initialize(file, se_inst)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="8">


          <code class="ruby">    @file = file</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">    @se_inst = se_inst</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    @invoice_items = Hash.new(0)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">    invoice_item_maker</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>

          <code class="ruby">  def open_contents</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">    CSV.open(file, headers: true, header_converters: :symbol)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>

          <code class="ruby">  def invoice_item_maker</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="19">


          <code class="ruby">    open_contents.each do |row|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">      id = row[:id].to_i</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby">      #add bigdecimal/Time for price/created_at/updated_at</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="22">


          <code class="ruby">      invoice_items[id] = InvoiceItem.new({:id =&gt; id, :item_id =&gt; row[:item_id].to_i, :invoice_id =&gt; row[:invoice_id].to_i, :quantity =&gt; row[:quantity].to_i, :unit_price =&gt; BigDecimal.new(row[:unit_price].to_i)/100, :created_at =&gt; Time.parse(row[:created_at]), :updated_at =&gt; Time.parse(row[:updated_at])}, self)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>

          <code class="ruby">  def all</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="27">


          <code class="ruby">    invoice_items.values</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>

          <code class="ruby">  def find_by_id(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="31">


          <code class="ruby">    invoice_items.has_key?(id) ? invoice_items[id] : nil</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>

          <code class="ruby">  def find_all_by_item_id(item_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="35">


          <code class="ruby">      all.select do |invoice_item|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="36">


          <code class="ruby">        invoice_item.item_id == item_id.to_i</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>

          <code class="ruby">  def find_all_by_invoice_id(invoice_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="41">


          <code class="ruby">    all.select do |invoice_item|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="42">


          <code class="ruby">      invoice_item.invoice_id == invoice_id.to_i</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="44">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="47">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="48">


          <code class="ruby">  # def find_all_by_name(fragment)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="49">


          <code class="ruby">  #   found_invoice_items = @invoice_items.values.map do |invoice_item|</code>
        </li>

        <li class="never" data-hits="" data-linenumber="50">


          <code class="ruby">  #     if invoice_item.name.downcase.include?(fragment.downcase)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="51">


          <code class="ruby">  #       invoice_item</code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby">  #     end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="53">


          <code class="ruby">  #   end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="54">


          <code class="ruby">  #   found_invoice_items.compact</code>
        </li>

        <li class="never" data-hits="" data-linenumber="55">


          <code class="ruby">  # end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="56">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>

          <code class="ruby">  def inspect</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="58">


          <code class="ruby">    &quot;#&lt;#{self.class} #{@invoice_items.size} rows&gt;&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="59">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="60">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="f6af1c7cd54d0507283b8bd83523ec9b966f5c96">
  <div class="header">
    <h3>lib/invoice_repository.rb</h3>
    <h4><span class="red">47.06 %</span> covered</h4>
    <div>
      <b>34</b> relevant lines.
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>18</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">require_relative &#39;invoice&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">require &#39;csv&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">require &#39;pry&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">require &#39;bigdecimal&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">require &#39;time&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">class InvoiceRepository</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>

          <code class="ruby">  attr_reader :file, :invoices, :se_inst</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>

          <code class="ruby">  def initialize(file, se_inst)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    @file = file</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">    @se_inst = se_inst</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">    @invoices = Hash.new(0)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    invoice_maker</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>

          <code class="ruby">  def open_contents</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">    CSV.open(file, headers: true, header_converters: :symbol)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>

          <code class="ruby">  def invoice_maker</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">    open_contents.each do |row|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="22">


          <code class="ruby">    id = row[:id].to_i</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="23">


          <code class="ruby">    invoices[id] = Invoice.new({:id =&gt; id, :customer_id =&gt; row[:customer_id].to_i, :status =&gt; row[:status].to_sym,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">    :created_at =&gt; Time.parse(row[:created_at].to_s), :updated_at =&gt; Time.parse(row[:updated_at]), :merchant_id =&gt; row[:merchant_id].to_i}, self)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>

          <code class="ruby">  def all</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">    invoices.values</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>

          <code class="ruby">  def find_by_id(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="33">


          <code class="ruby">    invoices.has_key?(id) ? invoices[id] : nil</code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>

          <code class="ruby">  def find_all_by_status(status)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="37">


          <code class="ruby">    all.select do |invoice|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="38">


          <code class="ruby">      invoice.status == status.to_sym</code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="40">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>

          <code class="ruby">  def find_all_by_customer_id(customer_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="43">


          <code class="ruby">    all.select do |invoice|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="44">


          <code class="ruby">      invoice.customer_id == customer_id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="47">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="48">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>

          <code class="ruby">  def find_all_by_merchant_id(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="50">


          <code class="ruby">    merchant = all.find_all do |item|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="51">


          <code class="ruby">      item.merchant_id == id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="53">


          <code class="ruby">    merchant</code>
        </li>

        <li class="never" data-hits="" data-linenumber="54">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="55">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="56">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>

          <code class="ruby">  def inspect</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="58">


          <code class="ruby">    &quot;#&lt;#{self.class} #{@invoices.size} rows&gt;&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="59">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="60">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="36d7b4b235c219515069af3fd75d6c24f1f7740f">
  <div class="header">
    <h3>lib/item.rb</h3>
    <h4><span class="red">66.67 %</span> covered</h4>
    <div>
      <b>24</b> relevant lines.
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>8</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">require &#39;bigdecimal&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">require &#39;pry&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">require &#39;time&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">class Item</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">attr_reader :item_info, :ir_instance</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">  def initialize(item_info, ir_instance)</code>
        </li>

        <li class="covered" data-hits="550" data-linenumber="7">
          <span class="hits">550</span>

          <code class="ruby">    @item_info = item_info</code>
        </li>

        <li class="covered" data-hits="550" data-linenumber="8">
          <span class="hits">550</span>

          <code class="ruby">    @ir_instance = ir_instance</code>
        </li>

        <li class="never" data-hits="" data-linenumber="9">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>

          <code class="ruby">  def name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">    @item_info[:name]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>

          <code class="ruby">  def id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">    @item_info[:id]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>

          <code class="ruby">  def unit_price</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">    @item_info[:unit_price]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="21">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>

          <code class="ruby">  def description</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="24">


          <code class="ruby">    @item_info[:description]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>

          <code class="ruby">  def created_at</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="28">


          <code class="ruby">    @item_info[:created_at]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>

          <code class="ruby">  def updated_at</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="32">


          <code class="ruby">    @item_info[:updated_at]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>

          <code class="ruby">  def merchant_id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="36">


          <code class="ruby">    @item_info[:merchant_id]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>

          <code class="ruby">  def merchant</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="40">


          <code class="ruby">    ir_instance.se_inst.merchants.find_by_id(merchant_id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="d519c8788af8cca267b5f4025649c81dbd321fc4">
  <div class="header">
    <h3>lib/item_repository.rb</h3>
    <h4><span class="red">59.52 %</span> covered</h4>
    <div>
      <b>42</b> relevant lines.
      <span class="green"><b>25</b> lines covered</span> and
      <span class="red"><b>17</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">require_relative &#39;item&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">require &#39;csv&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">require &#39;pry&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">require &#39;bigdecimal&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">require &#39;time&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">class ItemRepository</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>

          <code class="ruby">  attr_reader :file, :items, :se_inst</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>

          <code class="ruby">  def initialize(file, se_inst)</code>
        </li>

        <li class="covered" data-hits="25" data-linenumber="10">
          <span class="hits">25</span>

          <code class="ruby">    @file = file</code>
        </li>

        <li class="covered" data-hits="25" data-linenumber="11">
          <span class="hits">25</span>

          <code class="ruby">    @se_inst = se_inst</code>
        </li>

        <li class="covered" data-hits="25" data-linenumber="12">
          <span class="hits">25</span>

          <code class="ruby">    @items = Hash.new(0)</code>
        </li>

        <li class="covered" data-hits="25" data-linenumber="13">
          <span class="hits">25</span>

          <code class="ruby">    item_maker</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>

          <code class="ruby">  def open_contents</code>
        </li>

        <li class="covered" data-hits="25" data-linenumber="17">
          <span class="hits">25</span>

          <code class="ruby">    CSV.open(file, headers: true, header_converters: :symbol)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>

          <code class="ruby">  def item_maker</code>
        </li>

        <li class="covered" data-hits="25" data-linenumber="21">
          <span class="hits">25</span>

          <code class="ruby">    open_contents.each do |row|</code>
        </li>

        <li class="covered" data-hits="550" data-linenumber="22">
          <span class="hits">550</span>

          <code class="ruby">    @items[row[:id].to_i] = Item.new({:id =&gt; row[:id].to_i, :name =&gt; row[:name], :unit_price =&gt; BigDecimal.new(row[:unit_price].to_i)/100,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">    :created_at =&gt; Time.parse(row[:created_at]), :updated_at =&gt; Time.parse(row[:updated_at]), :merchant_id =&gt; row[:merchant_id].to_i,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">    :description =&gt; row[:description]}, self)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>

          <code class="ruby">  def all</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="30">


          <code class="ruby">    items.values</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>

          <code class="ruby">  def find_by_id(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="34">


          <code class="ruby">    items.has_key?(id) ? items[id] : nil</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>

          <code class="ruby">  def find_by_name(name)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="38">


          <code class="ruby">    found_item = all.find do |item|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="39">


          <code class="ruby">      item.name.downcase == name.downcase</code>
        </li>

        <li class="never" data-hits="" data-linenumber="40">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="41">


          <code class="ruby">    found_item</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>

          <code class="ruby">  def find_all_with_description(fragment)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="45">


          <code class="ruby">    found_descriptions = all.map do |item|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="46">


          <code class="ruby">      if item.description.downcase.include?(fragment.downcase)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="47">


          <code class="ruby">        item</code>
        </li>

        <li class="never" data-hits="" data-linenumber="48">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="49">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="50">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="51">


          <code class="ruby">    found_descriptions.compact</code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="53">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>

          <code class="ruby">  def find_all_by_price(price)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="55">


          <code class="ruby">    all.find_all do |item|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="56">


          <code class="ruby">      item.unit_price == price</code>
        </li>

        <li class="never" data-hits="" data-linenumber="57">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="58">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="59">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>

          <code class="ruby">  def find_all_by_price_in_range(range)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="61">


          <code class="ruby">    all.find_all do |instance|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="62">


          <code class="ruby">       range.include?(instance.unit_price)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="63">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="64">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="65">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>

          <code class="ruby">  def find_all_by_merchant_id(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="67">


          <code class="ruby">    merchant = all.find_all do |item|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="68">


          <code class="ruby">      item.merchant_id == id</code>
        </li>

        <li class="never" data-hits="" data-linenumber="69">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="70">


          <code class="ruby">    merchant</code>
        </li>

        <li class="never" data-hits="" data-linenumber="71">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="72">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>

          <code class="ruby">  def inspect</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="74">


          <code class="ruby">    &quot;#&lt;#{self.class} #{@items.size} rows&gt;&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="75">


          <code class="ruby">    #possibly need to change @merchants to @items, check harness</code>
        </li>

        <li class="never" data-hits="" data-linenumber="76">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="77">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="7ec9e8fd8e7804df328160abe3c36fa32816898a">
  <div class="header">
    <h3>lib/merchant.rb</h3>
    <h4><span class="red">57.89 %</span> covered</h4>
    <div>
      <b>19</b> relevant lines.
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>8</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Merchant</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  attr_reader :merchant_info, :mr_instance</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  def initialize(merchant_info, mr_instance)</code>
        </li>

        <li class="covered" data-hits="300" data-linenumber="4">
          <span class="hits">300</span>

          <code class="ruby">    @merchant_info = merchant_info</code>
        </li>

        <li class="covered" data-hits="300" data-linenumber="5">
          <span class="hits">300</span>

          <code class="ruby">    @mr_instance = mr_instance</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>

          <code class="ruby">  def name</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">    merchant_info[:name]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>

          <code class="ruby">  def id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    merchant_info[:id]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>

          <code class="ruby">  def created_at</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">    merchant_info[:created_at]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>

          <code class="ruby">  def items</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">    mr_instance.se_inst.items.find_all_by_merchant_id(id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>

          <code class="ruby">  def invoices</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">    mr_instance.se_inst.invoices.find_all_by_merchant_id(id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>

          <code class="ruby">  def customers</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="30">


          <code class="ruby">    invoices = mr_instance.se_inst.invoices.find_all_by_merchant_id(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="31">


          <code class="ruby">    customer_ids = invoices.map { |invoice| invoice.customer_id }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="32">


          <code class="ruby">    final = customer_ids.uniq.map { |customer_id| mr_instance.se_inst.customers.find_by_id(customer_id) }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="bf55b889cea61203b31335916f3d1b6cc1c87606">
  <div class="header">
    <h3>lib/merchant_repository.rb</h3>
    <h4><span class="red">68.75 %</span> covered</h4>
    <div>
      <b>32</b> relevant lines.
      <span class="green"><b>22</b> lines covered</span> and
      <span class="red"><b>10</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">require_relative &#39;merchant&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">require &#39;csv&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">require &#39;pry&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">class MerchantRepository</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">  attr_reader :file, :merchants, :se_inst</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">  def initialize(file, se_inst)</code>
        </li>

        <li class="covered" data-hits="25" data-linenumber="7">
          <span class="hits">25</span>

          <code class="ruby">    @file = file</code>
        </li>

        <li class="covered" data-hits="25" data-linenumber="8">
          <span class="hits">25</span>

          <code class="ruby">    @se_inst = se_inst</code>
        </li>

        <li class="covered" data-hits="25" data-linenumber="9">
          <span class="hits">25</span>

          <code class="ruby">    @merchants = Hash.new(0)</code>
        </li>

        <li class="covered" data-hits="25" data-linenumber="10">
          <span class="hits">25</span>

          <code class="ruby">    merchant_maker</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="12">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>

          <code class="ruby">  def open_contents</code>
        </li>

        <li class="covered" data-hits="25" data-linenumber="14">
          <span class="hits">25</span>

          <code class="ruby">    CSV.open(file, headers: true, header_converters: :symbol)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>

          <code class="ruby">  def merchant_maker</code>
        </li>

        <li class="covered" data-hits="25" data-linenumber="18">
          <span class="hits">25</span>

          <code class="ruby">    open_contents.each do |row|</code>
        </li>

        <li class="covered" data-hits="325" data-linenumber="19">
          <span class="hits">325</span>

          <code class="ruby">      id = row[:id].to_i</code>
        </li>

        <li class="covered" data-hits="325" data-linenumber="20">
          <span class="hits">325</span>

          <code class="ruby">      name = row[:name]</code>
        </li>

        <li class="covered" data-hits="325" data-linenumber="21">
          <span class="hits">325</span>

          <code class="ruby">      @merchants[id] = Merchant.new({:id =&gt; id, :name =&gt; name, :created_at =&gt; Time.parse(row[:created_at])}, self)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>

          <code class="ruby">  def all</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="26">


          <code class="ruby">    @merchants.values</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>

          <code class="ruby">  def find_by_id(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="30">


          <code class="ruby">    @merchants.has_key?(id) ? @merchants[id] : nil</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>

          <code class="ruby">  def find_by_name(naming)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="35">


          <code class="ruby">    found_merchant = all.detect do |merchant|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="36">


          <code class="ruby">      merchant.name.downcase == naming.downcase</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="38">


          <code class="ruby">    found_merchant</code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="40">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>

          <code class="ruby">  def find_all_by_name(fragment)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="42">


          <code class="ruby">    found_merchants = @merchants.values.map do |merchant|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="43">


          <code class="ruby">      if merchant.name.downcase.include?(fragment.downcase)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="44">


          <code class="ruby">        merchant</code>
        </li>

        <li class="never" data-hits="" data-linenumber="45">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="46">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="47">


          <code class="ruby">    found_merchants.compact</code>
        </li>

        <li class="never" data-hits="" data-linenumber="48">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="49">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>

          <code class="ruby">  def inspect</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="51">


          <code class="ruby">    &quot;#&lt;#{self.class} #{@merchants.size} rows&gt;&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="53">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="adda5699a402641ace8d09b8c6a979fcb2ef9de5">
  <div class="header">
    <h3>lib/sales_analyst.rb</h3>
    <h4><span class="red">28.37 %</span> covered</h4>
    <div>
      <b>141</b> relevant lines.
      <span class="green"><b>40</b> lines covered</span> and
      <span class="red"><b>101</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">  class SalesAnalyst</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  attr_reader :se_inst</code>
        </li>

        <li class="never" data-hits="" data-linenumber="3">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">  def initialize(se_inst)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">    @se_inst = se_inst</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>

          <code class="ruby">  def average_items_per_merchant</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">    (se_inst.items.all.count.to_f / se_inst.merchants.all.count.to_f).round(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>

          <code class="ruby">  def diff_btw_mean_and_item_c_sqrd_summed</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    mean = average_items_per_merchant</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">    get_merchant_items_set.map { |item_c| (item_c - mean) ** 2 }.reduce(:+)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="16">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>

          <code class="ruby">  def get_merchant_items_set</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="18">


          <code class="ruby">    se_inst.merchants.all.map { |merchant| merchant.items.count }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="20">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>

          <code class="ruby">  def average_items_per_merchant_standard_deviation</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="22">


          <code class="ruby">    set_length = (get_merchant_items_set.length - 1)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="23">


          <code class="ruby">    Math.sqrt(diff_btw_mean_and_item_c_sqrd_summed/set_length).round(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>

          <code class="ruby">  def merchants_with_high_item_count</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="27">


          <code class="ruby">    avg = average_items_per_merchant</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="28">


          <code class="ruby">    std_dev = (average_items_per_merchant_standard_deviation)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">    se_inst.merchants.all.select do |merchant|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="30">


          <code class="ruby">      merchant.items.count &gt;= (std_dev + avg)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>

          <code class="ruby">  def average_item_price_for_merchant(merchant_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="35">


          <code class="ruby">    item_list = se_inst.merchants.find_by_id(merchant_id).items</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="36">


          <code class="ruby">    (item_list.reduce(0.0) { |price_total, item| price_total + item.unit_price } / item_list.size).round(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>

          <code class="ruby">  def average_average_price_per_merchant</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="40">


          <code class="ruby">    merch_avgs = se_inst.merchants.all.map { |merchant| average_item_price_for_merchant(merchant.id) }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="41">


          <code class="ruby">    (merch_avgs.reduce(:+)/merch_avgs.count).round(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>

          <code class="ruby">  def average_item_price</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="45">


          <code class="ruby">    all_items = se_inst.items.all</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="46">


          <code class="ruby">    (all_items.reduce(0.0) { |total, item| total + item.unit_price} / all_items.count.to_f).round(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="47">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="48">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>

          <code class="ruby">  def get_item_price_set</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="50">


          <code class="ruby">    se_inst.items.all.map {|item| item.unit_price}</code>
        </li>

        <li class="never" data-hits="" data-linenumber="51">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="52">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>

          <code class="ruby">  def difference_between_mean_and_item_price_squared_summed</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="54">


          <code class="ruby">    mean = average_item_price</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="55">


          <code class="ruby">    get_item_price_set.map { |item_price| (item_price - mean) ** 2 }.reduce(:+).round(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="56">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="57">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>

          <code class="ruby">  def average_item_price_standard_deviation</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="59">


          <code class="ruby">    set_length = (get_item_price_set.length - 1)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="60">


          <code class="ruby">    Math.sqrt(difference_between_mean_and_item_price_squared_summed/set_length).round(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="61">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="62">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>

          <code class="ruby">  def golden_items</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="64">


          <code class="ruby">    avg = average_item_price</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="65">


          <code class="ruby">    std_dev = average_item_price_standard_deviation</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="66">


          <code class="ruby">    se_inst.items.all.select {|item| item.unit_price &gt;= (avg + (std_dev * 2)) }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="67">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="68">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>

          <code class="ruby">  def average_invoices_per_merchant</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="70">


          <code class="ruby">    (se_inst.invoices.all.count.to_f / se_inst.merchants.all.count.to_f).round(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="71">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="72">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>

          <code class="ruby">  def get_merchant_invoices_set</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="74">


          <code class="ruby">    se_inst.merchants.all.map do |merchant|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="75">


          <code class="ruby">      se_inst.invoices.find_all_by_merchant_id(merchant.id).count</code>
        </li>

        <li class="never" data-hits="" data-linenumber="76">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="77">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="78">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="79">
          <span class="hits">1</span>

          <code class="ruby">  def difference_between_mean_and_invoice_count_squared_summed</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="80">


          <code class="ruby">    mean = average_invoices_per_merchant</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="81">


          <code class="ruby">    get_merchant_invoices_set.map { |invoices| (invoices - mean) ** 2 }.reduce(:+).round(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="82">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="83">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="84">
          <span class="hits">1</span>

          <code class="ruby">  def average_invoices_per_merchant_standard_deviation</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="85">


          <code class="ruby">    set_length = (get_merchant_invoices_set.count - 1)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="86">


          <code class="ruby">    Math.sqrt(difference_between_mean_and_invoice_count_squared_summed/set_length).round(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="87">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="88">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="89">
          <span class="hits">1</span>

          <code class="ruby">  def top_merchants_by_invoice_count</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="90">


          <code class="ruby">    std_dev = average_invoices_per_merchant_standard_deviation</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="91">


          <code class="ruby">    avg = average_invoices_per_merchant</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="92">


          <code class="ruby">    se_inst.merchants.all.select do |merchant|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="93">


          <code class="ruby">      merchant.invoices.count &gt;= (avg + (std_dev * 2))</code>
        </li>

        <li class="never" data-hits="" data-linenumber="94">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="95">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="96">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="97">
          <span class="hits">1</span>

          <code class="ruby">  def bottom_merchants_by_invoice_count</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="98">


          <code class="ruby">    std_dev = average_invoices_per_merchant_standard_deviation</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="99">


          <code class="ruby">    avg = average_invoices_per_merchant</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="100">


          <code class="ruby">    se_inst.merchants.all.select do |merchant|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="101">


          <code class="ruby">      merchant.invoices.count &lt;= (avg - (std_dev * 2))</code>
        </li>

        <li class="never" data-hits="" data-linenumber="102">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="103">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="104">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="105">
          <span class="hits">1</span>

          <code class="ruby">  def invoice_status(status)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="106">


          <code class="ruby">    status_count = se_inst.invoices.all.count do |invoice|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="107">


          <code class="ruby">      invoice.status == status</code>
        </li>

        <li class="never" data-hits="" data-linenumber="108">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="109">


          <code class="ruby">    (100 * status_count.to_f / se_inst.invoices.all.count.to_f).round(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="110">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="111">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="112">
          <span class="hits">1</span>

          <code class="ruby">  def get_wdays</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="113">


          <code class="ruby">    se_inst.invoices.all.map do |invoice|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="114">


          <code class="ruby">      invoice.created_at.wday</code>
        </li>

        <li class="never" data-hits="" data-linenumber="115">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="116">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="117">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="118">
          <span class="hits">1</span>

          <code class="ruby">  def days_of_the_week</code>
        </li>

        <li class="never" data-hits="" data-linenumber="119">


          <code class="ruby">  {&quot;Sunday&quot; =&gt; 0,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="120">


          <code class="ruby">   &quot;Monday&quot; =&gt; 1,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="121">


          <code class="ruby">   &quot;Tuesday&quot; =&gt; 2,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="122">


          <code class="ruby">   &quot;Wednesday&quot; =&gt; 3,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="123">


          <code class="ruby">   &quot;Thursday&quot; =&gt; 4,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="124">


          <code class="ruby">   &quot;Friday&quot; =&gt; 5,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="125">


          <code class="ruby">   &quot;Saturday&quot; =&gt; 6</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="126">


          <code class="ruby"> }.invert</code>
        </li>

        <li class="never" data-hits="" data-linenumber="127">


          <code class="ruby">end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="128">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="129">
          <span class="hits">1</span>

          <code class="ruby">  def frequency_created_per_day</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="130">


          <code class="ruby">    day_count = Hash.new(0)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="131">


          <code class="ruby">      get_wdays.each do |wday_num|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="132">


          <code class="ruby">      day_count[days_of_the_week[wday_num]] += 1</code>
        </li>

        <li class="never" data-hits="" data-linenumber="133">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="134">


          <code class="ruby">    day_count</code>
        </li>

        <li class="never" data-hits="" data-linenumber="135">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="136">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="137">
          <span class="hits">1</span>

          <code class="ruby">  def average_invoices_per_day</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="138">


          <code class="ruby">    frequencies = frequency_created_per_day.values</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="139">


          <code class="ruby">    (frequencies.reduce(:+).to_f / frequencies.count.to_f).round(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="140">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="141">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="142">
          <span class="hits">1</span>

          <code class="ruby">  def diff_btw_mean_and_day_frequency_sqrd_summed</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="143">


          <code class="ruby">    mean = average_invoices_per_day</code>
        </li>

        <li class="never" data-hits="" data-linenumber="144">


          <code class="ruby">    frequency_created_per_day.values.map do |day_freq|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="145">


          <code class="ruby">      (day_freq - mean) ** 2</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="146">


          <code class="ruby">    end.reduce(:+).round(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="147">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="148">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="149">
          <span class="hits">1</span>

          <code class="ruby">  def average_frequency_per_day_standard_deviation</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="150">


          <code class="ruby">    set_length = (frequency_created_per_day.values.count - 1)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="151">


          <code class="ruby">    Math.sqrt(diff_btw_mean_and_day_frequency_sqrd_summed/set_length).round(2)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="152">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="153">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="154">
          <span class="hits">1</span>

          <code class="ruby">  def top_days_by_invoice_count</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="155">


          <code class="ruby">    avg = average_invoices_per_day</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="156">


          <code class="ruby">    std_dev = average_frequency_per_day_standard_deviation</code>
        </li>

        <li class="never" data-hits="" data-linenumber="157">


          <code class="ruby">    frequency_created_per_day.select do |day, frequency|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="158">


          <code class="ruby">      frequency &gt;= (std_dev + avg)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="159">


          <code class="ruby">    end.keys</code>
        </li>

        <li class="never" data-hits="" data-linenumber="160">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="161">


          <code class="ruby"> # merchants invoices for the day specified &gt; then all invoice_items &gt; then sum all invoice items, not including failed transactions, so only the successful ones.</code>
        </li>

        <li class="never" data-hits="" data-linenumber="162">


          <code class="ruby">  # def total_revenue_by_date(date)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="163">


          <code class="ruby">  #   found_invoices = se_inst.invoices.all.select do |invoice|</code>
        </li>

        <li class="never" data-hits="" data-linenumber="164">


          <code class="ruby">  #       invoice.created_at.strftime(&quot;%Y-%m-%d&quot;) == date.strftime(&quot;%Y-%m-%d&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="165">


          <code class="ruby">  #     end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="166">


          <code class="ruby">  #     all_trans = se_inst.transactions</code>
        </li>

        <li class="never" data-hits="" data-linenumber="167">


          <code class="ruby">  #     found_invoices.map do |invoice|</code>
        </li>

        <li class="never" data-hits="" data-linenumber="168">


          <code class="ruby">  #       if all_trans.find_all_by_invoice_id(invoice.id).each { |transaction| transaction.result == &quot;success&quot; ? next : found_invoices.delete(invoice)  }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="169">


          <code class="ruby">  #       # all_trans.find_all_by_invoice_id(invoice.id).select do |transaction|</code>
        </li>

        <li class="never" data-hits="" data-linenumber="170">


          <code class="ruby">  #       #   transaction.result == &quot;success&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="171">


          <code class="ruby">  #       end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="172">


          <code class="ruby">  #     end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="173">


          <code class="ruby">  #   end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="174">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="175">
          <span class="hits">1</span>

          <code class="ruby">  def find_invoices_by_date(date)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="176">


          <code class="ruby">      se_inst.invoices.all.select do |invoice|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="177">


          <code class="ruby">        invoice.created_at.strftime(&quot;%Y-%m-%d&quot;) == date.strftime(&quot;%Y-%m-%d&quot;)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="178">


          <code class="ruby">      end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="179">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="180">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="181">
          <span class="hits">1</span>

          <code class="ruby">  def total_revenue_by_date(date)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="182">


          <code class="ruby">    found_invoices = find_invoices_by_date(date)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="183">


          <code class="ruby">    found_invoices.reduce(0) { |sum, invoice| sum += invoice.total }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="184">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="185">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="186">
          <span class="hits">1</span>

          <code class="ruby">  def merchant_invoice_totals</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="187">


          <code class="ruby">    merchants_total_hash = Hash.new(0)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="188">


          <code class="ruby">     selection = se_inst.invoices</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="189">


          <code class="ruby">     se_inst.merchants.all.each do |merchant|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="190">


          <code class="ruby">       merchants_total_hash[merchant] += selection.find_all_by_merchant_id(merchant.id).reduce(0) do |sum, invoice|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="191">


          <code class="ruby">         sum += invoice.total</code>
        </li>

        <li class="never" data-hits="" data-linenumber="192">


          <code class="ruby">       end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="193">


          <code class="ruby">     end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="194">


          <code class="ruby">     merchants_total_hash</code>
        </li>

        <li class="never" data-hits="" data-linenumber="195">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="196">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="197">
          <span class="hits">1</span>

          <code class="ruby">  def top_revenue_earners(x = 20)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="198">


          <code class="ruby">     whats_this = merchant_invoice_totals.sort_by {|k, v| v}.reverse.to_h.keys[0...x]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="199">


          <code class="ruby">    #se_inst.merchants.sort_by(:total_sales).first(20)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="200">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="201">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="202">
          <span class="hits">1</span>

          <code class="ruby">  def merchants_ranked_by_revenue</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="203">


          <code class="ruby">    merchant_invoice_totals.sort_by {|k, v| v}.reverse.to_h.keys</code>
        </li>

        <li class="never" data-hits="" data-linenumber="204">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="205">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="206">
          <span class="hits">1</span>

          <code class="ruby">  def merchants_with_pending_invoices</code>
        </li>

        <li class="never" data-hits="" data-linenumber="207">


          <code class="ruby">    # paid_invoices = se_inst.invoices.paid_invoices</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="208">


          <code class="ruby">    invoices = se_inst.invoices.all.select { |invoice| !invoice.is_paid_in_full? == true }</code>
        </li>

        <li class="never" data-hits="" data-linenumber="209">


          <code class="ruby">      invoices.map do |invoice|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="210">


          <code class="ruby">        se_inst.merchants.find_by_id(invoice.merchant_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="211">


          <code class="ruby">      end.uniq</code>
        </li>

        <li class="never" data-hits="" data-linenumber="212">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="213">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="214">
          <span class="hits">1</span>

          <code class="ruby">  def merchants_with_only_one_item</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="215">


          <code class="ruby">    se_inst.merchants.all.select {|merchant| merchant.items.count == 1}</code>
        </li>

        <li class="never" data-hits="" data-linenumber="216">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="217">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="218">
          <span class="hits">1</span>

          <code class="ruby">  def merchants_with_only_one_item_registered_in_month(month)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="219">


          <code class="ruby">    month_merchants = se_inst.merchants.all.select do |merchant|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="220">


          <code class="ruby">      merchant.created_at.strftime(&quot;%B&quot;).downcase == month.downcase</code>
        </li>

        <li class="never" data-hits="" data-linenumber="221">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="222">


          <code class="ruby">    month_merchants.select do |merchant|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="223">


          <code class="ruby">      merchant.items.count == 1</code>
        </li>

        <li class="never" data-hits="" data-linenumber="224">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="225">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="226">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="227">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="228">
          <span class="hits">1</span>

          <code class="ruby">  def revenue_by_merchant(merchant_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="229">


          <code class="ruby">    found_invoices = se_inst.merchants.find_by_id(merchant_id).invoices</code>
        </li>

        <li class="never" data-hits="" data-linenumber="230">


          <code class="ruby">    found_invoices.map do |invoice|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="231">


          <code class="ruby">      invoice.total</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="232">


          <code class="ruby">    end.reduce(:+)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="233">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="234">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="235">
          <span class="hits">1</span>

          <code class="ruby">  def most_sold_item_for_merchant(merchant_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="236">


          <code class="ruby">    sold_count = Hash.new(0)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="237">


          <code class="ruby">    invoices = se_inst.merchants.find_by_id(merchant_id).invoices</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="238">


          <code class="ruby">    invoice_items = invoices.map do |invoice|#makeitsownmethod</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="239">


          <code class="ruby">      invoice.is_paid_in_full? ? se_inst.invoice_items.find_all_by_invoice_id(invoice.id) : next</code>
        </li>

        <li class="never" data-hits="" data-linenumber="240">


          <code class="ruby">    end.flatten(1).compact</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="241">


          <code class="ruby">    invoice_items.each do |item|#makeitsownmethod</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="242">


          <code class="ruby">      sold_count[item.item_id] += item.quantity</code>
        </li>

        <li class="never" data-hits="" data-linenumber="243">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="244">


          <code class="ruby">    high_item_ids = sold_count.select {|k, v| k if v == sold_count.values.max }</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="245">


          <code class="ruby">    final = high_item_ids.keys.map do |item_id|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="246">


          <code class="ruby">      se_inst.items.find_by_id(item_id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="247">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="248">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="249">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="250">
          <span class="hits">1</span>

          <code class="ruby">  def best_item_for_merchant(merchant_id) #refactor</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="251">


          <code class="ruby">    revenue_count = Hash.new(0)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="252">


          <code class="ruby">    invoices = se_inst.merchants.find_by_id(merchant_id).invoices</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="253">


          <code class="ruby">    invoice_items = invoices.map do |invoice|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="254">


          <code class="ruby">      invoice.is_paid_in_full? ? se_inst.invoice_items.find_all_by_invoice_id(invoice.id) : next</code>
        </li>

        <li class="never" data-hits="" data-linenumber="255">


          <code class="ruby">    end.flatten(1).compact</code>
        </li>

        <li class="never" data-hits="" data-linenumber="256">


          <code class="ruby"></code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="257">


          <code class="ruby">    invoice_items.each do |item|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="258">


          <code class="ruby">      revenue_count[item.item_id] += (item.quantity * item.unit_price)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="259">


          <code class="ruby">    end</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="260">


          <code class="ruby">    high_revenue_items = revenue_count.select {|k, v| k if v == revenue_count.values.max}</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="261">


          <code class="ruby">    se_inst.items.find_by_id(high_revenue_items.keys[0])</code>
        </li>

        <li class="never" data-hits="" data-linenumber="262">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="263">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="ddc95a70e5f6fd92fd404dc085fe545edf8ef231">
  <div class="header">
    <h3>lib/sales_engine.rb</h3>
    <h4><span class="red">80.0 %</span> covered</h4>
    <div>
      <b>20</b> relevant lines.
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">require_relative &quot;merchant_repository&quot;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">require_relative &quot;item_repository&quot;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">require_relative &quot;invoice_repository&quot;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>

          <code class="ruby">require_relative &quot;invoice_item_repository&quot;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>

          <code class="ruby">require_relative &quot;transaction_repository&quot;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">require_relative &quot;customer_repository&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>

          <code class="ruby">class SalesEngine</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>

          <code class="ruby">    attr_accessor :paths, :items, :merchants, :invoices, :invoice_items, :transactions, :customers</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>

          <code class="ruby">  def initialize (hash)</code>
        </li>

        <li class="covered" data-hits="25" data-linenumber="11">
          <span class="hits">25</span>

          <code class="ruby">    @paths = hash</code>
        </li>

        <li class="covered" data-hits="25" data-linenumber="12">
          <span class="hits">25</span>

          <code class="ruby">    @items = ItemRepository.new(@paths[:items], self) unless @paths[:items].nil?</code>
        </li>

        <li class="covered" data-hits="25" data-linenumber="13">
          <span class="hits">25</span>

          <code class="ruby">    @merchants = MerchantRepository.new(@paths[:merchants], self) unless @paths[:merchants] == nil</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="14">


          <code class="ruby">    @invoices = InvoiceRepository.new(@paths[:invoices], self) unless @paths[:invoices] == nil</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="15">


          <code class="ruby">    @invoice_items = InvoiceItemRepository.new(@paths[:invoice_items], self) unless @paths[:invoice_items] == nil</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">    @transactions = TransactionRepository.new(@paths[:transactions], self) unless @paths[:transactions] == nil</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">    @customers = CustomerRepository.new(@paths[:customers], self) unless @paths[:customers] == nil</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>

          <code class="ruby">  def self.from_csv(hash)</code>
        </li>

        <li class="covered" data-hits="25" data-linenumber="21">
          <span class="hits">25</span>

          <code class="ruby">    files = hash.each_pair do |key, value|</code>
        </li>

        <li class="covered" data-hits="75" data-linenumber="22">
          <span class="hits">75</span>

          <code class="ruby">      @paths[key] = value</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">    end</code>
        </li>

        <li class="covered" data-hits="25" data-linenumber="24">
          <span class="hits">25</span>

          <code class="ruby">    SalesEngine.new(files)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="c4da46909e26004c5a2c40d600ef72d38e1a5743">
  <div class="header">
    <h3>lib/transaction.rb</h3>
    <h4><span class="red">52.38 %</span> covered</h4>
    <div>
      <b>21</b> relevant lines.
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>10</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">class Transaction</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">  attr_reader :transaction_info, :trans_inv_instance</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">  def initialize (transaction_info, trans_inv_instance)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="4">


          <code class="ruby">    @transaction_info = transaction_info</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="5">


          <code class="ruby">    @trans_inv_instance = trans_inv_instance</code>
        </li>

        <li class="never" data-hits="" data-linenumber="6">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="7">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>

          <code class="ruby">  def id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">    transaction_info[:id]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="10">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="11">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>

          <code class="ruby">  def invoice_id</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="13">


          <code class="ruby">    transaction_info[:invoice_id]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="15">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>

          <code class="ruby">  def credit_card_number</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="17">


          <code class="ruby">    transaction_info[:credit_card_number]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="19">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>

          <code class="ruby">  def result</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">    transaction_info[:result]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="22">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>

          <code class="ruby">  def created_at</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="25">


          <code class="ruby">    transaction_info[:created_at]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>

          <code class="ruby">  def updated_at</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="29">


          <code class="ruby">    transaction_info[:updated_at]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="30">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="31">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>

          <code class="ruby">  def credit_card_expiration_date</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="33">


          <code class="ruby">    transaction_info[:credit_card_expiration_date]</code>
        </li>

        <li class="never" data-hits="" data-linenumber="34">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="35">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>

          <code class="ruby">  def invoice</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="37">


          <code class="ruby">    trans_inv_instance.se_inst.invoices.find_by_id(invoice_id)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="38">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="39">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="40">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

        <div class="source_table" id="f4b419e7b607729b85013de15074ff443f2b5cdb">
  <div class="header">
    <h3>lib/transaction_repository.rb</h3>
    <h4><span class="red">45.16 %</span> covered</h4>
    <div>
      <b>31</b> relevant lines.
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>17</b> lines missed.</span>
    </div>
  </div>

  <pre>
    <ol>

        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>

          <code class="ruby">require_relative &#39;transaction&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>

          <code class="ruby">require &#39;csv&#39;</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>

          <code class="ruby">require &#39;pry&#39;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="4">


          <code class="ruby"></code>
        </li>

        <li class="never" data-hits="" data-linenumber="5">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>

          <code class="ruby">class TransactionRepository</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>

          <code class="ruby">  attr_reader :file, :transactions, :se_inst</code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>

          <code class="ruby">  def initialize(file, se_inst)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="9">


          <code class="ruby">    @file = file</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="10">


          <code class="ruby">    @se_inst = se_inst</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="11">


          <code class="ruby">    @transactions = Hash.new(0)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="12">


          <code class="ruby">    transaction_maker</code>
        </li>

        <li class="never" data-hits="" data-linenumber="13">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="14">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>

          <code class="ruby">  def open_contents</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="16">


          <code class="ruby">    CSV.open(file, headers: true, header_converters: :symbol)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="17">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="18">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>

          <code class="ruby">  def transaction_maker</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="20">


          <code class="ruby">    open_contents.each do |row|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="21">


          <code class="ruby">      id = row[:id].to_i</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="22">


          <code class="ruby">      transactions[id] = Transaction.new({:id =&gt; id, :credit_card_number =&gt;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="23">


          <code class="ruby">        row[:credit_card_number].to_i, :invoice_id =&gt; row[:invoice_id].to_i,</code>
        </li>

        <li class="never" data-hits="" data-linenumber="24">


          <code class="ruby">        :credit_card_expiration_date =&gt; row[:credit_card_expiration_date],</code>
        </li>

        <li class="never" data-hits="" data-linenumber="25">


          <code class="ruby">        :result =&gt; row[:result], :created_at =&gt; Time.parse(row[:created_at]),</code>
        </li>

        <li class="never" data-hits="" data-linenumber="26">


          <code class="ruby">        :updated_at =&gt; Time.parse(row[:updated_at])}, self)</code>
        </li>

        <li class="never" data-hits="" data-linenumber="27">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="28">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="29">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>

          <code class="ruby">  def all</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="31">


          <code class="ruby">    transactions.values</code>
        </li>

        <li class="never" data-hits="" data-linenumber="32">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="33">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>

          <code class="ruby">  def find_by_id(id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="35">


          <code class="ruby">    transactions.has_key?(id) ? transactions[id] : nil</code>
        </li>

        <li class="never" data-hits="" data-linenumber="36">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="37">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>

          <code class="ruby">  def find_all_by_invoice_id(invoice_id)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="39">


          <code class="ruby">      all.select do |transaction|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="40">


          <code class="ruby">      transaction.invoice_id == invoice_id.to_i</code>
        </li>

        <li class="never" data-hits="" data-linenumber="41">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="42">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="43">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>

          <code class="ruby">  def find_all_by_credit_card_number(credit_card_number)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="45">


          <code class="ruby">      all.select do |transaction|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="46">


          <code class="ruby">      transaction.credit_card_number == credit_card_number.to_i</code>
        </li>

        <li class="never" data-hits="" data-linenumber="47">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="48">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="49">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>

          <code class="ruby">  def find_all_by_result(result)</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="51">


          <code class="ruby">      all.select do |transaction|</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="52">


          <code class="ruby">      transaction.result == result.downcase</code>
        </li>

        <li class="never" data-hits="" data-linenumber="53">


          <code class="ruby">    end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="54">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="55">


          <code class="ruby"></code>
        </li>

        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>

          <code class="ruby">  def inspect</code>
        </li>

        <li class="missed" data-hits="0" data-linenumber="57">


          <code class="ruby">    &quot;#&lt;#{self.class} #{@transactions.size} rows&gt;&quot;</code>
        </li>

        <li class="never" data-hits="" data-linenumber="58">


          <code class="ruby">  end</code>
        </li>

        <li class="never" data-hits="" data-linenumber="59">


          <code class="ruby">end</code>
        </li>

    </ol>
  </pre>
</div>

      </div>
    </div>
  </body>
</html>
